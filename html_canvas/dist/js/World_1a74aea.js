!function(){function i(i,t){this.ground=[],this.personRecord=[],this.width=i,this.height=t,this.stoneNumber=10,this.init()}function t(t){return t===i.grass}i.stone="●●●●",i.grass="△△△△",i.wall="▇▇▇▇",i.prototype={init:function(){for(var i=0;i<this.width;i++){this.personRecord[i]=[],this.ground[i]=[];for(var t=0;t<this.height;t++)this.personRecord[i][t]=null,this.ground[i][t]=null}this.createGrass(),this.createWalls(),this.createStones()},createGrass:function(){for(var t=0;t<this.width;t++)for(var r=0;r<this.height;r++)this.ground[t][r]=i.grass},createWalls:function(){for(var t=1;t<this.width;t+=2)for(var r=1;r<this.height;r+=2)this.ground[t][r]=i.wall},createStones:function(){for(var r=0;r<this.stoneNumber;r++){for(var n=Util.getRandomInt(0,this.width-1),o=Util.getRandomInt(0,this.height-1);!t(this.ground[n][o]);)n=Util.getRandomInt(0,this.width-1),o=Util.getRandomInt(0,this.height-1);this.ground[n][o]=i.stone}},clear:function(t,r){for(var n=0;n<this.width;n++)for(var o=0;o<this.height;o++)this.ground[n][o]=i.grass,this.personRecord[t][r]=null},reset:function(t,r){isNaN(t)||isNaN(r)||(this.ground[t][r]=i.grass,this.personRecord[t][r]=null)},show:function(){console.info();for(var i=0;i<this.width;i++){for(var t="",r=0;r<this.height;r++)t+=this.ground[i][r]+" ";console.info(t)}},setPerson:function(i,t,r){this.ground[i][t]=r.name,this.personRecord[i][t]=r},stoneBetweenPersons:function(t,r,n,o){if(t===n){if(Math.abs(r-o)<=1)return!1;for(var s=o>r?r:o,h=o>r?o:r,e=s+1;h>e;e++)if(this.ground[t][e]===i.stone)return!0}else{if(Math.abs(t-n)<=1)return!1;for(var a=n>t?t:n,f=n>t?n:t,e=a+1;f>e;e++)if(this.ground[e][r]===i.stone)return!0}return!1},draw:function(){for(var t=0;t<this.width;t++)for(var r=0;r<this.height;r++)switch(this.ground[t][r]){case i.grass:this.drawGrass(t,r);break;case i.wall:this.drawWall(t,r);break;case i.stone:this.drawStone(t,r);break;default:console.info("Illegal thing:"+this.ground[t][r])}},drawGrass:function(i,t){var r=window.pen;r.fillStyle=Config.grassColor,r.fillRect(i*Config.brickWidth,t*Config.brickWidth,Config.brickWidth,Config.brickWidth),r.strokeRect(i*Config.brickWidth,t*Config.brickWidth,Config.brickWidth,Config.brickWidth)},drawWall:function(i,t){var r=window.pen,n=i*Config.brickWidth,o=t*Config.brickWidth;r.drawImage(Config.wallImg,n,o,Config.brickWidth,Config.brickWidth)},drawStone:function(i,t){var r=window.pen,n=i*Config.brickWidth,o=t*Config.brickWidth;r.drawImage(Config.stoneImg,n,o,Config.brickWidth,Config.brickWidth)}},i.drawGrass=function(i,t){var r=window.pen;r.fillStyle=Config.grassColor,r.fillRect(i*Config.brickWidth,t*Config.brickWidth,Config.brickWidth,Config.brickWidth),r.strokeRect(i*Config.brickWidth,t*Config.brickWidth,Config.brickWidth,Config.brickWidth)},i.drawWall=function(i,t){var r=window.pen;r.fillStyle=Config.wallColor,r.fillRect(i*Config.brickWidth,t*Config.brickWidth,Config.brickWidth,Config.brickWidth)},window.World=i}();